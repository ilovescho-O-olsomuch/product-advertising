## 数据清洗
``` python
import pandas as pd

# 读取数据
file_path = r"C:\Users\32165\Desktop\Advertising_Data.csv"
df = pd.read_csv(file_path)

# 检查广告投入字段是否有空值
ad_columns = ["TV", "Billboards", "Google_Ads", "Social_Media", "Influencer_Marketing", "Affiliate_Marketing"]
missing_values = df[ad_columns].isnull().sum()
print("广告投入空值统计：")
print(missing_values)

# 用中位数填充空值
for col in ad_columns:
    df[col].fillna(df[col].median(), inplace=True)

# 检查 Product_Sold 是否为空或为 0，并剔除
invalid_records = df[(df["Product_Sold"].isnull()) | (df["Product_Sold"] == 0)]
print(f"发现 {len(invalid_records)} 条无效记录，将被删除。")
df = df.dropna(subset=["Product_Sold"])
df = df[df["Product_Sold"] > 0]

# 使用 IQR 方法检测异常值
def detect_outliers_iqr(data, column):
    Q1 = data[column].quantile(0.25)
    Q3 = data[column].quantile(0.75)
    IQR = Q3 - Q1
    lower_bound = Q1 - 1.5 * IQR
    upper_bound = Q3 + 1.5 * IQR
    return (data[column] < lower_bound) | (data[column] > upper_bound)

# 计算异常值
outlier_mask = detect_outliers_iqr(df, "Product_Sold")
for col in ad_columns:
    outlier_mask |= detect_outliers_iqr(df, col)

# 找到异常值并输出完整数据
outliers = df[outlier_mask]
print(f"发现 {len(outliers)} 条异常值数据：")
print(outliers.to_string())  # 确保所有列完整显示

# 删除异常值
df = df[~outlier_mask]

# 保存清洗后的数据
cleaned_file_path = r"C:\Users\32165\Desktop\Advertising_Data_Cleaned.csv"
df.to_csv(cleaned_file_path, index=False)

print(f"数据清洗完成，已保存至 {cleaned_file_path}")
